# Redis Configuration for API Key Manager
# Based on design requirements for ACL and security

# Basic settings
port 6379
bind 0.0.0.0
protected-mode yes

# Persistence - AOF for durability
appendonly yes
appendfsync everysec
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# Memory settings
maxmemory-policy allkeys-lru

# Security settings
# ACL configuration takes precedence over requirepass
# requirepass your_secure_redis_password

# Enable ACL
aclfile /data/users.acl

# Logging
loglevel notice
logfile ""

# Client settings
timeout 300
tcp-keepalive 300

# Enable modules (Redis Stack includes JSON and other modules)
# loadmodule /opt/redis-stack/lib/redisearch.so
# loadmodule /opt/redis-stack/lib/redistimeseries.so
# loadmodule /opt/redis-stack/lib/rejson.so

# Performance tuning
tcp-backlog 511
databases 16

# Disable dangerous commands in production
# rename-command FLUSHDB ""
# rename-command FLUSHALL ""
# rename-command KEYS ""
# rename-command CONFIG ""
